# üü©üü©üü©üü©‚¨ú Issue #18 üõ°Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏: –°–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏

**–°—Ç–∞—Ç—É—Å:** `‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ (—á–∞—Å—Ç–∏—á–Ω–æ)`

## 1. üìù –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **–°–µ—Ä–≤–∏—Å–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏**, –∫–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ **–ó–∞–¥–∞—á–µ #18**. –•–æ—Ç—è –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å `RiskManagementService` –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω, –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –¥–≤—É—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö: `BuyOrderMonitor` –∏ `TradingService`. –≠—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Ä–∏—Å–∫–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å "–ø—Ä–æ—Ç—É—Ö—à–∏–º–∏" –æ—Ä–¥–µ—Ä–∞–º–∏ –∏ –Ω–µ–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º–∏ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏.

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ä–µ–¥—Å—Ç–≤–∞—Ö –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–∏—Å–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞, —Ç–∞–∫–∏—Ö –∫–∞–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤–æ–∑—Ä–∞—Å—Ç–∞ –æ—Ä–¥–µ—Ä–∞, –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.

## 2. üéØ –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏

**–ó–∞–¥–∞—á–∞ #18** —Ç—Ä–µ–±–æ–≤–∞–ª–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Ä–≤–∏—Å–∞ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤. –ö–ª—é—á–µ–≤—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –±—ã–ª–∏:
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤.
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—Ç—å —É–±—ã—Ç–∫–∏ –æ—Ç –æ—Ä–¥–µ—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±–æ–ª—å—à–µ –Ω–µ —è–≤–ª—è—é—Ç—Å—è –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω—ã–º–∏ –∏–∑-–∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –Ω–∞ —Ä—ã–Ω–∫–µ.
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ —Å–ª—É—á–∞–µ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏.
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å –ø–µ—Ä–µ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –æ—Ä–¥–µ—Ä–æ–≤ (—ç—Ç–æ –Ω–µ—è–≤–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä–æ–º –∫ –±–∏—Ä–∂–µ).

## 3. üõ†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–°—Ç—Ä–∞—Ç–µ–≥–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ —Å–∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è `BuyOrderMonitor` –∏ `TradingService`.

### 3.1. üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- **`BuyOrderMonitor`**: –≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –¥–µ–π—Å—Ç–≤—É–µ—Ç –∫–∞–∫ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ –Ω–∞ –ü–û–ö–£–ü–ö–£. –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞, –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—è "–ø—Ä–æ—Ç—É—Ö—à–∏–µ" –æ—Ä–¥–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç–º–µ–Ω–∏—Ç—å –∏ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å.
- **`TradingService`**: –≠—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å, –≤—ã—Å—Ç—É–ø–∞—è –≤ —Ä–æ–ª–∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–∏—Å–∫–æ–≤, —Ç–∞–∫–∏–µ –∫–∞–∫ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–¥–µ–ª–∫–∏, —á—Ç–æ —Å–ª—É–∂–∏—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π.

### 3.2. üß© –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ –∏—Ö —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ

- **`domain/services/buy_order_monitor.py`**:
    - `BuyOrderMonitor`: –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ "–ø—Ä–æ—Ç—É—Ö—à–∏—Ö" –æ—Ä–¥–µ—Ä–æ–≤ –Ω–∞ –ü–û–ö–£–ü–ö–£.
    - `start_monitoring()`: –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.
    - `check_stale_buy_orders()`: –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∞. –û–Ω –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ü–û–ö–£–ü–ö–£ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏—Ö –ø–æ –¥–≤—É–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º —Ä–∏—Å–∫–∞:
        1.  **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç**: –û—Ä–¥–µ—Ä —Å—á–∏—Ç–∞–µ—Ç—Å—è "–ø—Ä–æ—Ç—É—Ö—à–∏–º", –µ—Å–ª–∏ –æ–Ω –±—ã–ª –æ—Ç–∫—Ä—ã—Ç –¥–æ–ª—å—à–µ, —á–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `max_age_minutes`.
        2.  **–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã**: –û—Ä–¥–µ—Ä —Å—á–∏—Ç–∞–µ—Ç—Å—è "–ø—Ä–æ—Ç—É—Ö—à–∏–º", –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è —Ä—ã–Ω–æ—á–Ω–∞—è —Ü–µ–Ω–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Ä–æ—Å–ª–∞ –≤—ã—à–µ —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø–æ–∫—É–ø–∫—É (–±–æ–ª–µ–µ —á–µ–º –Ω–∞ `max_price_deviation_percent`), —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ –≤—ã–≥–æ–¥–Ω–æ–π —Ü–µ–Ω–µ –º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω—ã–º.
    - `_handle_stale_buy_order()`: –ï—Å–ª–∏ –æ—Ä–¥–µ—Ä –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ "–ø—Ä–æ—Ç—É—Ö—à–∏–π", —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ –æ—Ç–º–µ–Ω—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –æ—Ä–¥–µ—Ä –∏ –ø—ã—Ç–∞–µ—Ç—Å—è –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –µ–≥–æ –ø–æ –Ω–æ–≤–æ–π, –±–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω–æ–π —Ü–µ–Ω–µ.

- **`domain/services/trading_service.py`**:
    - `TradingService`: –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä.
    - `force_close_all_deals()`: –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏: –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –æ—Ä–¥–µ—Ä–∞ –∏ –∑–∞–∫—Ä—ã—Ç—å –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ —Å–¥–µ–ª–∫–∏. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω–æ –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–∏–≥–Ω–∞–ª–æ–º —Ç—Ä–µ–≤–æ–≥–∏ –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ–π —Ç–æ—Ä–≥–æ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö —É–±—ã—Ç–∫–æ–≤ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ–º —Ä—ã–Ω–∫–µ –∏–ª–∏ –≤ —Å–ª—É—á–∞–µ —Å–±–æ—è —Å–∏—Å—Ç–µ–º—ã.

## 4. üîç –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ –∫–æ–¥–µ

- **[‚úÖ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `BuyOrderMonitor`**
  - **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:** –§–∞–π–ª `domain/services/buy_order_monitor.py` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ï–≥–æ –º–µ—Ç–æ–¥ `check_stale_buy_orders` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ä–¥–µ—Ä–∞ –ø–æ `max_age_minutes` –∏ `max_price_deviation_percent`.

- **[‚úÖ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `SignalCooldownManager`**
  - **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:** –§–∞–π–ª `domain/services/signal_cooldown_manager.py` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `TradingDecisionEngine` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —á–∞—Å—Ç–æ—Ç—ã —Å–¥–µ–ª–æ–∫.

- **[‚úÖ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏**
  - **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:** –ü–∞—Ä–∞–º–µ—Ç—Ä `deal_quota` –≤ `domain/entities/currency_pair.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `run_realtime_trading.py` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `ticker_service.calculate_strategy`.

- **[‚úÖ] –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏**
  - **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ:** –ú–µ—Ç–æ–¥ `emergency_stop_all_trading` –≤ `domain/services/order_execution_service.py` –≤—ã–∑—ã–≤–∞–µ—Ç –æ—Ç–º–µ–Ω—É –≤—Å–µ—Ö –æ—Ä–¥–µ—Ä–æ–≤.

- **[‚ùå] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Stop-Loss**
  - **–°—Ç–∞—Ç—É—Å:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ. –í —Å–∏—Å—Ç–µ–º–µ –Ω–µ—Ç –ª–æ–≥–∏–∫–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –ø—Ä–æ–¥–∞–∂—É –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —É–±—ã—Ç–∫–æ–≤ –ø–æ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏.

## 5. üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–≠—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
# –í –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
order_service = OrderService(...)
exchange_connector = CcxtExchangeConnector(...)
buy_order_monitor = BuyOrderMonitor(
    order_service=order_service,
    exchange_connector=exchange_connector,
    max_age_minutes=15,
    max_price_deviation_percent=3.0
)

# –ó–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
asyncio.create_task(buy_order_monitor.start_monitoring())

# –í —Å–ª—É—á–∞–µ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ TradingService –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
trading_service = TradingService(...)

# –≠—Ç–æ –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω–æ —Å—É–ø–µ—Ä–≤–∏–∑–æ—Ä–æ–º –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è –∏–ª–∏ —Ä—É—á–Ω—ã–º —Ç—Ä–∏–≥–≥–µ—Ä–æ–º
await trading_service.force_close_all_deals()
```

## 5. üèÅ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏, —Ö–æ—Ç—è –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –º–µ–∂–¥—É –¥–≤—É–º—è —Å–µ—Ä–≤–∏—Å–∞–º–∏, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–µ—à–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è **–ó–∞–¥–∞—á–∏ #18**. `BuyOrderMonitor` –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é, –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω—É—é –∑–∞—â–∏—Ç—É –æ—Ç "–ø—Ä–æ—Ç—É—Ö—à–∏—Ö" –æ—Ä–¥–µ—Ä–æ–≤, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ `TradingService` –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ä–µ–∞–∫—Ç–∏–≤–Ω—É—é, –æ–±—â–µ—Å–∏—Å—Ç–µ–º–Ω—É—é "—Å–µ—Ç–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏". –≠—Ç–∞ –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Å–æ–∑–¥–∞–µ—Ç –Ω–∞–¥–µ–∂–Ω—É—é –æ—Å–Ω–æ–≤—É –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–≤—ã—à–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞.